@startuml
class App {
+ catalog : Catalog
+ tickets : TicketBook
+ cashiers : UserRegister
+ customers : UserRegister
- modules : HashMap<handlerId : String, RequestHandler>
- input : InputDriver
- config : Config
+ App()
+ init() : void
+ {static} main(args : String[]) : void
- handleRequest(request : Request) : Action
- exec(Action) : void
- echo(request : Request) : void
- help() : void
- exit() : void
}

class Config {
+ Config()
+ getMaxProducts() : int
+ getMaxProductsPerTicket() : int
}

App *-- Config

enum EventType {
FOOD(72)
MEETING(12)
- planningTime : int
+ EventType(planningTime : int)
+ getPlanTime() : int
}

enum Category {
MERCH(0)
STATIONERY(5)
CLOTHES(7)
BOOK(10)
ELECTRONICS(3)
- discount : double
+ Category(discount : double)
+ getDiscount() : double
+ toSentenceCase(eventType : EventType) : String
}

class InputDriver {
- input : Scanner
+ InputDriver()
+ InputDriver(file : String)
+ next() : Request
}

App *-- InputDriver

class Request {
+ handlerId : String
+ actionId : String
+ args : ArrayList<String>
+ Request(line : String)
- tokenize(line : String) : ArrayList<String>
}

Request <-- InputDriver : Creates

class RequestHandler {
- actions : HashMap<actionId : String, Action>
+ getAction(request : Request) : Action
+ getActions() : HashMap<actionId : String, Action>
}

App *-- "0...n" RequestHandler
Action <-- App : Executes
Action <-- RequestHandler : Sends To App
Request <-- RequestHandler: Receives

RequestHandler <|-- TicketHandler
RequestHandler <|-- UserHandler
RequestHandler <|-- ProductHandler

UserHandler <|-- CashierHandler
UserHandler <|-- CustomerHandler

abstract Action {
+ Action(App)
+ {abstract} exec(args : String[]) : int
+ {abstract} help() : void
}

package TicketHandlerActions {
Action <|.. AddTicket
Action <|.. AddProductToTicket
Action <|.. RemoveProductFromTicket
Action <|.. PrintTicket
Action <|.. ListTickets
}

note top of ListTickets: Also used by CashierHandler

package ProductHandlerActions {
Action <|.. AddProduct
Action <|.. UpdateProduct
Action <|.. AddEvent
Action <|.. ListProducts
Action <|.. RemoveProduct
}

package UserHandlerActions {
Action <|.. AddUser
Action <|.. RemoveUser
Action <|.. ListUsers

class AddUser {
+ AddUser(userRegisterId : id)
}

class RemoveUser {
+ RemoveUser(userRegisterId : id)
}

class ListUsers {
+ ListUser(userRegisterId : id)
}

RemoveUser <|-- RemoveCashier
}


class Catalog {
- products : HashMap<productId : int, ProductBase>
+ getProduct(id : int) : Product
+ getProducts() : HashMap<productId : int, ProductBase>
+ add(ProductBase) : int
# getNewId() : int
+ deleteProduct(id : int) : int
}

App *-- Catalog
Category <-- Catalog : Checks
EventType <-- Catalog : Checks

abstract class BaseProduct {
- id : int
- name : String
- price : double
+ BaseProduct(id : int, name : String, price : Double)
+ getId() : int
+ getPrice() : Double
+ setPrice() : void
+ getName() : String
+ setName : void
}

Catalog *-- "0...n" BaseProduct

class Product {
- category : Category
+ Product(category : String)
}

BaseProduct <|-- Product

class CustomProduct {
- maxPers : int
+ Personalizable(maxPers : int)
+ getMaxPers() : int
}

Product <|-- CustomProduct

class Event {
- expireDate : LocalDate
- maxPeople : int
- type : EventType
+ Event(expireDate : LocalDate, maxPeople : int, eventType : EventType)
+ getExpireDate() : LocalDate
+ getMaxPeople() : int
+ getType() : EventType
}

BaseProduct <|-- Event

class UserRegister {
- users: HashMap<userId: String, User>
+ UserRegister()
+ getUser(userId : String) : User
+ add(User) : int
+ removeUser(userId : String) : int
+ listUsers() : int
}

App *-- "2" UserRegister

class User {
- name : String
- email : Email
+ User(name : String, email : String)
+ getName() : String
+ getEmail() : Email
}

UserRegister *-- "0...n" User

class Email {
- username : String
- domain : String
+ Email(username : String, domain : String)
+ getUsername() : String
+ getDomain() : String
}

User *-- Email

class Customer {
+ Customer(cashierId : int)
+ getCashId() : int
}

User <|-- Customer

class TicketBook {
- tickets : Hashmap<ticketId : int, ticketEntry : TicketEntry>
- userToTicket : Hashmap<userId : String, ticketIds : String[]>
+ TicketBook()
+ getTicket(ticketId: int) : Ticket
+ add(Ticket) : int
+ getTickets() : Hashmap<ticketId : int, TicketEntry>
+ getTicketsFromUser(userId : String) : Hashmap<ticketId : int, TicketEntry>
+ getTicketsWithProd(prodId : int) : ArrayList<Ticket>
+ deleteProdFromTickets(ticketsDelete : ArrayList<Ticket>, prodId : int) : void
}

App *-- TicketBook

struct TicketEntry {
+ cashId : String
+ customerId : String
+ ticket : Ticket
}

TicketBook *-- "0...n" TicketEntry

class Ticket {
- products: HashMap<productId : int, amount: int>
- categories : HashMap<Category, amount: int>
- creationDate : LocalDateTime
- id : int
- closingDate : LocalDateTime
+ Ticket()
+ add(Product, amount: int) : int
+ removeProduct(prodId: int) : int
+ printTicket() : void
+ hasProduct(prodId : int) : boolean
+ isClosed() : boolean
}

TicketEntry *-- Ticket

@enduml
