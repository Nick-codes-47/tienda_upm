@startuml
class App {
+ catalog : Catalog
+ tickets : TicketBook
+ cashiers : UserRegister
+ customers : UserRegister
- modules : HashMap<handlerId : String, RequestHandler>
- input : InputDriver
- config : Config
+ App()
+ init()
+ {static} main(args : String[])
- handleRequest(request : Request) : Action
- exec(Action)
- echo(request : Request
- help()
- exit()
}

class InputDriver {
- input : Scanner
+ InputDriver()
+ InputDriver(file : String)
+ next() : Request
}

App *-- InputDriver

package Requests {

class Request {
+ handlerId : String
+ actionId : String
+ args : ArrayList<String>
+ Request(line : String)
- tokenize(line : String) : ArrayList<String>
}

Request <-- InputDriver : Creates

class RequestHandler {
- actions : HashMap<actionId : String, Action>
+ getAction(request : Request) : Action
+ getActions() : HashMap<actionId : String, Action>
}

}
' Requests

App *-- "0...n" RequestHandler
Action <-- App : Executes
Action <-- RequestHandler : Sends To App
Request <-- RequestHandler: Receives

abstract Action {
+ Action(App)
+ {abstract} exec(args : String[]) : int
+ {abstract} help() : void
}

package ProductContainer {

class Catalog {
- products : HashMap<productId : int, BaseProduct>
- MAX_PRODUCTS : int
+ Catalog()
+ getProduct(id : int) : BaseProduct
+ getProducts() : HashMap<productId : int, BaseProduct>
+ add(BaseProduct) : int
+ getNewId() : int
+ deleteProduct(id : int) : BaseProduct
+ existsId(id : int) : boolean
}

App *-- Catalog

package ProductTypes {

abstract class BaseProduct {
- id : int
- name : String
- price : double
+ BaseProduct(id : int, name : String, price : Double)
+ getId() : int
+ getPrice() : Double
+ getName() : String
+ setName()
}

Catalog *-- "0...n" BaseProduct

class Product {
- category : Category
+ Product(category : String)
}

BaseProduct <|-- Product

class CustomProduct {
- maxPers : int
- personalizations : ArrayList<String>
+ CustomProduct(maxPers : int)
+ setPersonalizations(personalizations : ArrayList<String>)
+ getMaxPers() : int
}

Product <|-- CustomProduct

class Event {
- expireDate : LocalDate
- maxPeople : int
- actualPeople : int
- MAX_PEOPLE_ALLOWED : int
- type : EventType
+ Event(expireDate : LocalDate, maxPeople : int, eventType : EventType)
+ getExpireDate() : LocalDate
+ getType() : EventType
+ setActualPeople(actualPeople : int)
}

BaseProduct <|-- Event

package ProductEnums {

enum EventType {
FOOD(72)
MEETING(12)
- planningTime : int
+ EventType(planningTime : int)
+ getPlanningTime() : int
{static} + toSentenceCase() : String
}

enum Category {
MERCH(0)
STATIONERY(5)
CLOTHES(7)
BOOK(10)
ELECTRONICS(3)
- discount : double
+ Category(discount : double)
+ getDiscount() : double
+ getCategories() : String
+ getCategoriesWithDiscount() : String
}

}

}

}

package UserContainer {

class UserRegister {
- users: HashMap<userId: String, User>
+ UserRegister()
+ getUser(userId : String) : User
+ add(User) : int
+ removeUser(userId : String) : int
+ listUsers() : int
}

App *-- "2" UserRegister

class User {
- name : String
- email : Email
+ User(name : String, email : String)
+ getName() : String
+ getEmail() : Email
}

UserRegister *-- "0...n" User

class Email {
- username : String
- domain : String
+ Email(username : String, domain : String)
+ getUsername() : String
+ getDomain() : String
}

User *-- Email

class Customer {
+ Customer(cashierId : int)
+ getCashId() : int
}

User <|-- Customer

}

package TicketContainer {

class TicketBook {
- tickets : Hashmap<ticketId : int, ticketEntry : TicketEntry>
- userToTicket : Hashmap<userId : String, ticketIds : String[]>
+ TicketBook()
+ getTicket(ticketId: int) : Ticket
+ add(Ticket) : int
+ getTickets() : Hashmap<ticketId : int, TicketEntry>
+ getTicketsFromUser(userId : String) : Hashmap<ticketId : int, TicketEntry>
+ getTicketsWithProd(prodId : int) : ArrayList<Ticket>
+ deleteProdFromTickets(ticketsDelete : ArrayList<Ticket>, prodId : int) : void
}

App *-- TicketBook

struct TicketEntry {
+ cashId : String
+ customerId : String
+ ticket : Ticket
}

TicketBook *-- "0...n" TicketEntry

class Ticket {
- products: HashMap<productId : int, amount: int>
- categories : HashMap<Category, amount: int>
- creationDate : LocalDateTime
- id : int
- closingDate : LocalDateTime
+ Ticket()
+ add(Product, amount: int) : int
+ removeProduct(prodId: int) : int
+ printTicket() : void
+ hasProduct(prodId : int) : boolean
+ isClosed() : boolean
}

TicketEntry *-- Ticket

}

@enduml
